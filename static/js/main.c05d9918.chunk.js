(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{14:function(e,t,n){e.exports=n(27)},19:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(11),s=n.n(i),r=(n(19),n(4)),l=n(5),d=n(7),h=n(6),c=n(1),p=n(8),u=n(12),m=n(2),x=function(){function e(){Object(r.a)(this,e),this._groups=[]}return Object(l.a)(e,[{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"groups",set:function(e){this._groups=e},get:function(){return this._groups}},{key:"startIndex",set:function(e){this._start=e},get:function(){return this._start}},{key:"endIndex",set:function(e){this._end=e},get:function(){return this._end}},{key:"depth",set:function(e){this._depth=e},get:function(){return this._depth}},{key:"title",set:function(e){this._title=e},get:function(){return this._title}},{key:"description",set:function(e){this._description=e},get:function(){return this._description}},{key:"selection",set:function(e){this._selection=e},get:function(){return this._selection}},{key:"color",set:function(e){this._color=e},get:function(){return this._color}}]),e}(),g=(n(24),["#e88","#ec5","#7a5","#48f","#99e","#e9d"]),b=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={isShowing:!1,isHighlighted:!1,color:n.props.color,isEditing:!1},n.handleOnShow=n.handleOnShow.bind(Object(c.a)(n)),n.handleOnClose=n.handleOnClose.bind(Object(c.a)(n)),n.handleColorChange=n.handleColorChange.bind(Object(c.a)(n)),n.handleHover=n.handleHover.bind(Object(c.a)(n)),n.handleEditMode=n.handleEditMode.bind(Object(c.a)(n)),n.handleViewMode=n.handleViewMode.bind(Object(c.a)(n)),n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"handleHover",value:function(){}},{key:"handleColorChange",value:function(e){this.setState({color:e}),this.props.annotation.color=e,this.props.updater(this.props.annotation,e)}},{key:"handleOnShow",value:function(){this.state.isShowing||this.setState({isShowing:!0})}},{key:"handleOnClose",value:function(e){document.getElementsByClassName("modal").length&&!document.getElementsByClassName("modal")[0].contains(e.target)&&this.setState({isShowing:!1}),e.stopPropagation()}},{key:"handleEditMode",value:function(){this.setState({isEditing:!this.state.isEditing})}},{key:"handleViewMode",value:function(){this.props.annotation.description=document.getElementById("updatedDescription").value,this.setState({isEditing:!this.state.isEditing})}},{key:"render",value:function(){var e=this,t=g.map((function(t){return o.a.createElement("span",{onClick:function(){return e.handleColorChange(t)},className:"color-selector",key:t,style:{backgroundColor:t}})}));return o.a.createElement("span",null,o.a.createElement("span",{className:(this.state.isHighlighted,"annotation-btn"),onMouseOver:this.handleHover,onClick:this.handleOnShow,style:{background:"linear-gradient(0deg, ".concat(this.props.annotation.color,", white 1px, transparent 1px)"),lineHeight:this.props.depth-1+20+"px",paddingBottom:4*(this.props.depth-1)+"px",color:this.props.annotation.color}},this.props.children),this.state.isShowing&&o.a.createElement("div",{className:"modal-bg",onClick:this.handleOnClose,style:{color:"black"}},o.a.createElement("div",{className:"modal"},o.a.createElement("div",{className:"modal-inner"},o.a.createElement("div",{className:"modal-header"},t),o.a.createElement("hr",null),!this.state.isEditing&&o.a.createElement("div",{className:"modal-desc"},o.a.createElement("span",{className:"modal-desc-text"},this.props.annotation.description),o.a.createElement("br",null),o.a.createElement("span",{className:"lowOptions",onClick:this.handleEditMode,size:5},o.a.createElement(m.d,null))),this.state.isEditing&&o.a.createElement("div",{className:"modal-desc"},o.a.createElement("textarea",{id:"updatedDescription",defaultValue:this.props.annotation.description}),o.a.createElement("button",{type:"button",onClick:this.handleViewMode},"Update Description"))))))}}]),t}(o.a.Component),E=["#e88","#ec5","#7a5","#48f","#99e","#e9d"],f=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={ANNOTATIONS:[],annotation_id:1,maxDepth:0,text:"",textPanes:[],isShowHelp:!0,isShowImport:!1,isShowImportAnnotations:!1,isShowExportAnnotations:!1},n.handleMouseUp=n.handleMouseUp.bind(Object(c.a)(n)),n.handleRerender=n.handleRerender.bind(Object(c.a)(n)),n.handleAppend=n.handleAppend.bind(Object(c.a)(n)),n.handleAppendEnter=n.handleAppendEnter.bind(Object(c.a)(n)),n.handleClear=n.handleClear.bind(Object(c.a)(n)),n.onSetSidebarOpen=n.onSetSidebarOpen.bind(Object(c.a)(n)),n.handleExample=n.handleExample.bind(Object(c.a)(n)),n.handleShowImport=n.handleShowImport.bind(Object(c.a)(n)),n.handleImportAppend=n.handleImportAppend.bind(Object(c.a)(n)),n.handleImportReplace=n.handleImportReplace.bind(Object(c.a)(n)),n.handleShowHelp=n.handleShowHelp.bind(Object(c.a)(n)),n.handleShowExportAnnotations=n.handleShowExportAnnotations.bind(Object(c.a)(n)),n.handleShowImportAnnotations=n.handleShowImportAnnotations.bind(Object(c.a)(n)),n.handleImportAnnotations=n.handleImportAnnotations.bind(Object(c.a)(n)),n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"handleRerender",value:function(e,t){this.reloadTextPanes(this.state.textPanes,e,t)}},{key:"reloadTextPanes",value:function(e,t,n){for(var a=0;a<e.length;a++)if(e[a].props&&e[a].props.children){var i=e[a].props.children;Array.isArray(i)||(i=[i]),this.reloadTextPanes(i,t,n),e[a]=o.a.createElement(b,{updater:this.handleRerender,key:e[a].key,depth:e[a].props.depth,annotation:e[a].props.annotation,color:e[a].props.annotation===t?n:e[a].props.annotation.color},i)}this.setState(this.state)}},{key:"handleMouseUp",value:function(){if(document.getElementsByClassName("modal").length)console.log("Hi");else if(document.getSelection()&&document.getSelection().toString().length>0){console.log("Why");var e=document.getSelection(),t=this.getUserInput(),n=new x;n.description=t,n.selection=e,this.styleSelection(e,n,"textbody"),e.empty()}}},{key:"getUserInput",value:function(){return window.prompt("What is this annotation for?","")}},{key:"styleSelection",value:function(e,t,n){if(t.id=this.state.annotation_id,t.startIndex=this.getTotalOffset(e.anchorNode,e.anchorOffset,n),t.endIndex=this.getTotalOffset(e.focusNode,e.focusOffset,n),t.startIndex>t.endIndex){var a=t.startIndex;t.startIndex=t.endIndex,t.endIndex=a}var o=this.getDepthRange(t);t.depth=o,this.setState({maxDepth:Math.max(this.state.maxDepth,o)}),console.log(t.startIndex),console.log(t.endIndex);for(var i=[],s=0,r=this.state.text.length,l=0;l<this.state.textPanes.length;l++){r="string"===typeof this.state.textPanes[l]||this.state.textPanes[l]instanceof String?s+this.state.textPanes[l].length:"br"===this.state.textPanes[l].type?s:this.state.textPanes[l].props.annotation.endIndex,console.log(this.state.textPanes[l]),console.log("Startind"),console.log(s),console.log("Endind"),console.log(r);var d=this.processAnnotation(t,this.state.textPanes[l],s,r);i=i.concat(d),s=r}this.setState({textPanes:i}),this.setState({annotation_id:this.state.annotation_id+1}),this.state.ANNOTATIONS.push(t)}},{key:"getDepthRange",value:function(e){for(var t=[],n=0;n<this.state.maxDepth+1;n++)t.push(n+1);var a=!0,o=!1,i=void 0;try{for(var s,r=this.state.ANNOTATIONS[Symbol.iterator]();!(a=(s=r.next()).done);a=!0){var l=s.value;l.startIndex<e.endIndex&&e.startIndex<l.endIndex&&(t[l.depth-1]=-1)}}catch(p){o=!0,i=p}finally{try{a||null==r.return||r.return()}finally{if(o)throw i}}for(var d=0,h=t;d<h.length;d++){var c=h[d];if(c>0)return c}return this.state.maxDepth+1}},{key:"getTotalOffset",value:function(e,t,n){for(var a=/(\t|\r)+/,o=t-(e.textContent.substring(0,t).length-e.textContent.substring(0,t).replace(a,"").length),i=e;i!==document.getElementById(n);)null!==i.previousSibling?o+=(i=i.previousSibling).textContent.replace(a,"").length:i=i.parentNode;return o}},{key:"processAnnotation",value:function(e,t,n,a){if(e.startIndex<a&&n<e.endIndex){if("string"===typeof t||t instanceof String){var i=e.startIndex>n?e.startIndex-n:0,s=a-n,r=e.endIndex>a?s:s-(a-e.endIndex);return e.color=E[0],[t.slice(0,i),o.a.createElement(b,{updater:this.handleRerender,key:parseInt(""+e.id+n+a),depth:e.depth,annotation:e,color:e.color},t.slice(i,r)),t.slice(r)]}if("br"===t.type)return[o.a.createElement("br",{key:t.key})];var l=t.props.children;Array.isArray(l)||(l=[l]);for(var d=[],h=0;h<l.length;h++)a="string"===typeof l[h]||l[h]instanceof String?n+l[h].length:l[h].props.annotation.endIndex,d=d.concat(this.processAnnotation(e,l[h],n,a)),n=a;return[o.a.createElement(b,{updater:this.handleRerender,key:parseInt(""+e.id+n+a),depth:t.props.depth,annotation:t.props.annotation,color:t.props.annotation.color},d)]}return t}},{key:"handleAppend",value:function(){var e=this.state.textPanes;e.push(""+document.getElementById("append-text").value),e.push(o.a.createElement("br",{key:parseInt("-1"+this.state.text.length+this.state.text.length)})),this.setState({textPanes:e,text:this.state.text+"\n"+document.getElementById("append-text").value}),document.getElementById("append-text").value=""}},{key:"handleAppendEnter",value:function(e){"Enter"==e.key&&this.handleAppend()}},{key:"handleImportReplace",value:function(){var e=[];e.push(""+document.getElementById("import-text").value),e.push(o.a.createElement("br",{key:parseInt("-1"+this.state.text.length+this.state.text.length)})),this.setState({ANNOTATIONS:[],annotation_id:1,maxDepth:0,text:"",textPanes:e}),document.getElementById("import-text").value=""}},{key:"handleImportAppend",value:function(){var e=this.state.textPanes;e.push(""+document.getElementById("import-text").value),e.push(o.a.createElement("br",{key:parseInt("-1"+this.state.text.length+this.state.text.length)})),this.setState({textPanes:e,text:this.state.text+"\n"+document.getElementById("import-text").value}),document.getElementById("import-text").value=""}},{key:"handleClear",value:function(){this.setState({ANNOTATIONS:[],annotation_id:1,keys:1,maxDepth:0,text:"",textPanes:[]})}},{key:"onSetSidebarOpen",value:function(e){this.setState({sidebarOpen:e})}},{key:"render",value:function(){var e=this,t=o.a.createElement("div",null,o.a.createElement("div",{className:"nav-append"},o.a.createElement("input",{type:"text",id:"append-text",onKeyUp:this.handleAppendEnter}),o.a.createElement("button",{onClick:this.handleAppend,type:"button"},"Append"),o.a.createElement("button",{onClick:this.handleClear,type:"button"},o.a.createElement(m.e,null))),o.a.createElement("div",{id:"textbody",onMouseUp:this.handleMouseUp},this.state.textPanes)),n=o.a.createElement("div",{className:"sideNav"},o.a.createElement("a",{className:"menuItem",href:"#",onClick:this.handleExample}," Example "),o.a.createElement("a",{className:"menuItem",href:"#",onClick:this.handleShowImport}," Import Plaintext ",this.state.isShowImport?o.a.createElement(m.c,null):o.a.createElement(m.b,null)),this.state.isShowImport&&o.a.createElement("div",null,o.a.createElement("textarea",{id:"import-text",style:{width:"100%",fontSize:"0.75em",height:"12em"},placeholder:"Enter text to input."}),o.a.createElement("button",{style:{width:"50%",fontSize:"0.75em"},onClick:this.handleImportReplace,type:"button"},"Replace"),o.a.createElement("button",{style:{width:"50%",fontSize:"0.75em"},onClick:this.handleImportAppend,type:"button"},"Append")),o.a.createElement("a",{className:"menuItem",href:"#",onClick:this.handleShowExportAnnotations}," Export Annotations ",this.state.isShowExportAnnotations?o.a.createElement(m.c,null):o.a.createElement(m.b,null)),this.state.isShowExportAnnotations&&o.a.createElement("div",null,o.a.createElement("textarea",{id:"export-annotations",style:{width:"100%",fontSize:"0.75em",height:"12em"},readOnly:!0,value:JSON.stringify(this.state)})),o.a.createElement("a",{className:"menuItem",href:"#",onClick:this.handleShowImportAnnotations}," Import Annotations ",this.state.isShowImportAnnotations?o.a.createElement(m.c,null):o.a.createElement(m.b,null)," "),this.state.isShowImportAnnotations&&o.a.createElement("div",null,o.a.createElement("textarea",{id:"import-annotations",style:{width:"100%",fontSize:"0.75em",height:"12em"}}),o.a.createElement("button",{style:{width:"100%",fontSize:"0.75em"},onClick:this.handleImportAnnotations,type:"button"},"Load")),o.a.createElement("a",{className:"menuItem",href:"#",onClick:this.handleShowHelp}," Help ",this.state.isShowHelp?o.a.createElement(m.c,null):o.a.createElement(m.b,null)),this.state.isShowHelp&&o.a.createElement("div",{style:{fontSize:"0.75em",padding:"0 0.25em"}},o.a.createElement("p",null,o.a.createElement("b",null,"Highlight")," a part of the text to add an annotation."),o.a.createElement("p",null,o.a.createElement("b",null,"Click")," an annotation to view it or modify it."),o.a.createElement("p",null,"Use the top ",o.a.createElement("b",null,"Append")," bar to add another line to the main text body. Use the ",o.a.createElement("b",null,"Import Plaintext")," option to append large blocks of text."),o.a.createElement("p",null,"Click on the ",o.a.createElement("b",null,"trash can")," to clear the body of text."),o.a.createElement("p",null,"Save the state of your notebook from ",o.a.createElement("b",null,"Export Annotations")," and reload it using ",o.a.createElement("b",null,"Import Annotations"),".")));return o.a.createElement("div",null,o.a.createElement(u.a,{sidebar:n,open:this.state.sidebarOpen,onSetOpen:this.onSetSidebarOpen,styles:{sidebar:{background:"white",width:"25%"}}},o.a.createElement("div",{className:"menuBar"},o.a.createElement("button",{style:{minHeight:"2em"},onClick:function(){return e.onSetSidebarOpen(!0)}},o.a.createElement(m.a,null)),o.a.createElement("span",null,"LangAnnotator")),t))}},{key:"handleExample",value:function(){var e=new x;e.id=1,e.color=E[1],e.depth=1,e.startIndex=19,e.endIndex=27,e.description="cambiar - verb\nto change";var t=new x;t.id=2,t.color=E[0],t.depth=1,t.startIndex=42,t.endIndex=46,t.description='emos/amos indicates that the pronoun is "us"';var n=new x;n.id=3,n.color=E[1],n.depth=1,n.startIndex=99,n.endIndex=105,n.description="cambiar";var a=new x;a.id=4,a.color=E[3],a.depth=1,a.startIndex=146,a.endIndex=162,a.description="Guatemalan activist and Nobel Peace prize winner",this.setState({ANNOTATIONS:[e,t,n,a],annotation_id:5,maxDepth:1,text:"Este mundo no va a cambiar a menos que estemos dispuestos a cambiar nosotros mismos\nThe world won't change unless we're willing to change ourselves\nRigoberta Menchu",textPanes:["Este mundo no va a ",o.a.createElement(b,{updater:this.handleRerender,key:parseInt(""+e.id+e.startIndex+e.endIndex),depth:e.depth,annotation:e,color:e.color},"cambiar")," a menos que est",o.a.createElement(b,{updater:this.handleRerender,key:parseInt(""+t.id+t.startIndex+t.endIndex),depth:t.depth,annotation:t,color:t.color},"emos")," dispuestos a cambiar nosotros mismos",o.a.createElement("br",{key:1}),"The world won't ",o.a.createElement(b,{updater:this.handleRerender,key:parseInt(""+n.id+n.startIndex+n.endIndex),depth:n.depth,annotation:n,color:n.color},"change")," unless we're willing to change ourselves",o.a.createElement("br",{key:2}),"",o.a.createElement(b,{updater:this.handleRerender,key:parseInt(""+a.id+a.startIndex+a.endIndex),depth:a.depth,annotation:a,color:a.color},"Rigoberta Menchu"),"",o.a.createElement("br",{key:3})]}),this.setState()}},{key:"handleShowHelp",value:function(){this.setState({isShowHelp:!this.state.isShowHelp})}},{key:"handleShowImport",value:function(){this.setState({isShowImport:!this.state.isShowImport})}},{key:"handleShowImportAnnotations",value:function(){this.setState({isShowImportAnnotations:!this.state.isShowImportAnnotations})}},{key:"handleShowExportAnnotations",value:function(){this.setState({isShowExportAnnotations:!this.state.isShowExportAnnotations})}},{key:"handleImportAnnotations",value:function(){var e=JSON.parse(document.getElementById("import-annotations").value);e.ANNOTATIONS=this.regenerateAnnotations(e.ANNOTATIONS),e.textPanes=this.regenerateTextPanes(e.textPanes,e.ANNOTATIONS),this.setState(e)}},{key:"regenerateAnnotations",value:function(e){for(var t,n=[],a=0;a<e.length;a++)(t=new x).id=e[a]._id,t.color=e[a]._color,t.depth=e[a]._depth,t.startIndex=e[a]._startIndex,t.endIndex=e[a]._endIndex,t.description=e[a]._description,n.push(t);return n}},{key:"regenerateTextPanes",value:function(e,t){for(var n=[],a=0;a<e.length;a++)"string"===typeof e[a]||e[a]instanceof String?n.push(e[a]):"br"==e[a].type?n.push(o.a.createElement("br",{key:e[a].key})):n.push(o.a.createElement(b,{updater:this.handleRerender,key:e[a].key,depth:e[a].props.depth,annotation:t[e[a].props.annotation._id-1],color:e[a].props.annotation.color},Array.isArray(e[a].props.children)?this.regenerateTextPanes(e[a].props.children,t):this.regenerateTextPanes([e[a].props.children],t)[0]));return n}}]),t}(o.a.Component),y=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={isExample:!0,sidebarOpen:!1},n.onSetSidebarOpen=n.onSetSidebarOpen.bind(Object(c.a)(n)),n.handleExample=n.handleExample.bind(Object(c.a)(n)),n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"onSetSidebarOpen",value:function(e){this.setState({sidebarOpen:e})}},{key:"handleExample",value:function(){this.setState({isExample:!0})}},{key:"render",value:function(){return console.log("rerender main page"),console.log(this.state.isExample),o.a.createElement(f,null)}}]),t}(o.a.Component);n(25),n(26);var S=function(){return o.a.createElement(y,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[14,1,2]]]);
//# sourceMappingURL=main.c05d9918.chunk.js.map