{"version":3,"sources":["components/MainText.js","components/MainPage.js","App.js","serviceWorker.js","index.js","components/AnnotationButton.js","components/Annotation.js"],"names":["colors","MainText","props","handleImportFileAnnotations","e","a","preventDefault","reader","FileReader","onload","text","target","result","document","getElementById","value","readAsText","files","state","ANNOTATIONS","annotation_id","maxDepth","defaultColorInd","textPanes","isShowHelp","isShowImport","isShowImportAnnotations","isShowExportAnnotations","handleMouseUp","bind","handleRerender","handleAppend","handleAppendEnter","handleClear","handleDeleteAnnotation","handleDefaultColor","onSetSidebarOpen","handleExample","handleShowImport","handleImportAppend","handleImportReplace","handleShowHelp","handleShowExportAnnotations","handleShowImportAnnotations","handleImportAnnotations","handleStartFileUpload","ann","color","this","reloadTextPanes","index","i","length","annotation","splice","apply","concat","children","setState","pane_list","modified_children","Array","isArray","updater","deleter","key","depth","getElementsByClassName","getSelection","toString","sel","input","getUserInput","Annotation","description","selection","styleSelection","empty","window","prompt","containerid","id","startIndex","getTotalOffset","anchorNode","anchorOffset","endIndex","focusNode","focusOffset","temp","getDepthRange","Math","max","updatedtextPanes","startInd","endInd","String","type","x","processAnnotation","push","validDepths","previous","d","anchor","escaped","offset","textContent","substring","replace","node","previousSibling","parentNode","new_annotation","prev_annotation","prev_start","prev_end","startHighlight","prev_len","endHighlight","slice","parseInt","prev_children","newPanes","keys","open","sidebarOpen","textbody","onMouseUp","sidebarContent","className","onClick","style","width","fontSize","height","placeholder","readOnly","Buffer","from","JSON","stringify","href","download","onChange","padding","sidebar","onSetOpen","styles","background","minHeight","onKeyUp","backgroundColor","visibility","a1","a2","a3","a4","encodedAnnotations","annotations","parse","regenerateAnnotations","regenerateTextPanes","click","regenerated","_depth","_start","_end","_description","_id","_color","ann_refs","React","Component","MainPage","isExample","App","Boolean","location","hostname","match","ReactDOM","render","navigator","serviceWorker","ready","then","registration","unregister","AnnotationButton","isShowing","isHighlighted","isEditing","handleDeleter","handleOnShow","handleOnClose","handleColorChange","handleHover","handleEditMode","handleViewMode","handleViewModeReset","c","contains","stopPropagation","color_buttons","map","onMouseOver","lineHeight","paddingBottom","size","defaultValue","class","_groups","nodes","start","end","title","_title","desc","_selection"],"mappings":"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","file":"static/js/main.221903b8.chunk.js","sourcesContent":["import React from 'react';\r\nimport Sidebar from 'react-sidebar';\r\nimport { FaBars, FaTrash, FaChevronCircleDown, FaChevronCircleUp } from 'react-icons/fa'\r\n\r\nimport Annotation from './Annotation'\r\nimport AnnotationButton from './AnnotationButton'\r\n\r\nconst colors = [\r\n\t\"#e88\", //red\r\n\t\"#ec5\", //orange\r\n\t\"#7a5\", //green\r\n\t\"#48f\", //blue\r\n\t\"#99e\", //violet\r\n\t\"#e9d\" //pink\r\n]\r\n\r\nexport default class MainText extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tANNOTATIONS: [],\r\n\t\t\tannotation_id: 1,\r\n\t\t\tmaxDepth: 0,\r\n\t\t\tdefaultColorInd: 0,\r\n\t\t\ttext: \"\",\r\n\t\t\ttextPanes: [],\r\n\t\t\tisShowHelp: true,\r\n\t\t\tisShowImport: false, \r\n\t\t\tisShowImportAnnotations: false,\r\n\t\t\tisShowExportAnnotations: false\r\n\t\t};\r\n\r\n\t\tthis.handleMouseUp = this.handleMouseUp.bind(this);\r\n\t\tthis.handleRerender = this.handleRerender.bind(this);\r\n\t\tthis.handleAppend = this.handleAppend.bind(this);\r\n\t\tthis.handleAppendEnter = this.handleAppendEnter.bind(this);\r\n\t\tthis.handleClear = this.handleClear.bind(this);\r\n\t\tthis.handleDeleteAnnotation = this.handleDeleteAnnotation.bind(this);\r\n\t\tthis.handleDefaultColor = this.handleDefaultColor.bind(this);\r\n\r\n\t\tthis.onSetSidebarOpen = this.onSetSidebarOpen.bind(this);\r\n\t\tthis.handleExample = this.handleExample.bind(this);\r\n\t\tthis.handleShowImport = this.handleShowImport.bind(this);\r\n\t\tthis.handleImportAppend = this.handleImportAppend.bind(this);\r\n\t\tthis.handleImportReplace = this.handleImportReplace.bind(this);\r\n\t\tthis.handleShowHelp = this.handleShowHelp.bind(this);\r\n\t\r\n\t\tthis.handleShowExportAnnotations = this.handleShowExportAnnotations.bind(this);\r\n\t\tthis.handleShowImportAnnotations = this.handleShowImportAnnotations.bind(this);\r\n\t\tthis.handleImportAnnotations = this.handleImportAnnotations.bind(this);\r\n\t\tthis.handleImportFileAnnotations = this.handleImportFileAnnotations.bind(this);\r\n\t\tthis.handleStartFileUpload = this.handleStartFileUpload.bind(this);\r\n\t}\r\n\r\n\thandleRerender(ann, color) { // update colors\r\n\t\tthis.reloadTextPanes(this.state.textPanes, ann, color);\r\n\t}\r\n\r\n\thandleDeleteAnnotation(ann) {\r\n\t\tvar index = -1;\r\n\t\tfor (var i = 0; i < this.state.textPanes.length; i++){\r\n\t\t\tif (this.state.textPanes[i].props && this.state.textPanes[i].props.annotation === ann.props.annotation) {\r\n\t\t\t\tindex = i;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (index > -1) {\r\n\t\t\tthis.state.textPanes.splice.apply(this.state.textPanes, [index, 1].concat(ann.props.children));\r\n\t\t\tthis.setState(this.state)\r\n\t\t}\r\n\t}\r\n\r\n\treloadTextPanes(pane_list, ann, color) {\r\n\t\tfor (var i=0; i<pane_list.length; i++){\r\n\t\t\tif (pane_list[i].props && pane_list[i].props.children) {\r\n\t\t\t\t//reload children\r\n\t\t\t\tvar modified_children = pane_list[i].props.children;\r\n\t\t\t\tif (!Array.isArray(modified_children)){\r\n\t\t\t\t\tmodified_children = [modified_children];\r\n\t\t\t\t}\r\n\t\t\t\tthis.reloadTextPanes(modified_children, ann, color);\r\n\r\n\t\t\t\tpane_list[i] =\r\n\t\t\t\t\t<AnnotationButton\r\n\t\t\t\t\t\tupdater={ this.handleRerender }\r\n\t\t\t\t\t\tdeleter={ this.handleDeleteAnnotation }\r\n\t\t\t\t\t\tkey={ pane_list[i].key }\r\n\t\t\t\t\t\tdepth={ pane_list[i].props.depth }\r\n\t\t\t\t\t\tannotation={ pane_list[i].props.annotation }\r\n\t\t\t\t\t\tcolor={ pane_list[i].props.annotation===ann ? color : pane_list[i].props.annotation.color } >\r\n\t\t\t\t\t\t{ modified_children }\r\n\t\t\t\t\t</AnnotationButton>;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.setState(this.state);\r\n\t}\r\n\r\n\thandleMouseUp(e) {\r\n\t\tif (document.getElementsByClassName(\"modal\").length){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (document.getSelection() && document.getSelection().toString().length>0) {    // all browsers, except IE before version 9\r\n\t\t\tvar sel = document.getSelection();\r\n        \tvar input = this.getUserInput();\r\n        \tif (!input){\r\n        \t\treturn\r\n        \t}\r\n        \tvar annotation = new Annotation();\r\n        \tannotation.description = input;\r\n        \tannotation.selection = sel;\r\n        \tannotation.color = colors[this.state.defaultColorInd];\r\n        \tthis.styleSelection(sel, annotation, \"textbody\");\r\n        \tsel.empty();\r\n  \t\t}\r\n\t}\r\n\r\n\tgetUserInput() {\r\n\t\treturn window.prompt(\"What is this annotation for?\",\"\");\r\n\t}\r\n\r\n\tstyleSelection(sel, annotation, containerid) {\r\n\t\tannotation.id = this.state.annotation_id;\r\n\t\tannotation.startIndex = this.getTotalOffset(sel.anchorNode, sel.anchorOffset, containerid);\r\n\t\tannotation.endIndex = this.getTotalOffset(sel.focusNode, sel.focusOffset, containerid);\r\n\r\n\t\tif (annotation.startIndex > annotation.endIndex) {\r\n\t\t\tvar temp = annotation.startIndex;\r\n\t\t\tannotation.startIndex = annotation.endIndex;\r\n\t\t\tannotation.endIndex = temp;\r\n\t\t}\r\n\r\n\t\tvar depth = this.getDepthRange(annotation);\r\n\t\tannotation.depth = depth;\r\n\t\tthis.setState({ maxDepth: Math.max(this.state.maxDepth, depth) });\r\n\r\n\t\t//no modification necessary\r\n\t\tvar updatedtextPanes = []\r\n\t\tvar startInd = 0;\r\n\t\tvar endInd = this.state.text.length;\r\n\r\n\t\tfor (var i=0; i<this.state.textPanes.length; i++){\r\n\t\t\tif (typeof this.state.textPanes[i] === 'string' || this.state.textPanes[i] instanceof String) {\r\n\t\t\t\tendInd = startInd + this.state.textPanes[i].length;\r\n\t\t\t}\r\n\t\t\telse if (this.state.textPanes[i].type==='br') {\r\n\t\t\t\tendInd = startInd; //while it is treated as \\n in text, it doesn't count as a valid reduction of length\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tendInd = this.state.textPanes[i].props.annotation.endIndex;\r\n\t\t\t}\r\n\t\t\tvar x = this.processAnnotation(annotation, this.state.textPanes[i], startInd, endInd);\r\n\t\t\tupdatedtextPanes=updatedtextPanes.concat(x);\r\n\t\t\tstartInd = endInd;\r\n\t\t}\r\n\r\n\t\tthis.setState({textPanes: updatedtextPanes});\r\n\t\tthis.setState({annotation_id: this.state.annotation_id+1});\r\n\t\tthis.state.ANNOTATIONS.push(annotation);\r\n\t}\r\n\r\n\tgetDepthRange(annotation) {\r\n\t\tvar validDepths = [];\r\n\t\tfor (var i=0; i<this.state.maxDepth+1; i++){\r\n\t\t\tvalidDepths.push(i+1);\r\n\t\t}\r\n\t\tfor (var previous of this.state.ANNOTATIONS) {\r\n\t\t\tif (previous.startIndex < annotation.endIndex && annotation.startIndex < previous.endIndex) {\r\n\t\t\t\tvalidDepths[previous.depth - 1] = -1;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var d of validDepths){\r\n\t\t\tif (d>0) {\r\n\t\t\t\treturn d;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this.state.maxDepth+1;\r\n\t}\r\n\r\n\tgetTotalOffset(anchor, anchorOffset, containerid) {\r\n\t\tvar escaped = /(\\t|\\r)+/;\r\n\t\tvar offset = anchorOffset - (anchor.textContent.substring(0,anchorOffset).length - anchor.textContent.substring(0,anchorOffset).replace(escaped,'').length);\r\n\t\tvar node = anchor;\r\n\t\twhile (node !== document.getElementById(containerid)) {\r\n\t\t\tif (node.previousSibling !== null) {\r\n\t\t\t\tnode = node.previousSibling;\r\n\t\t\t\toffset += node.textContent.replace(escaped,'').length;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn offset;\r\n\t}\r\n\r\n\tprocessAnnotation(new_annotation, prev_annotation, prev_start, prev_end){\r\n\t\t//intersects\r\n\t\tif (new_annotation.startIndex < prev_end && prev_start < new_annotation.endIndex) {\r\n\r\n\t\t\t//Base case - String\r\n\r\n\t\t\tif (typeof prev_annotation === 'string' || prev_annotation instanceof String){\r\n\t\t\t\tvar startHighlight = new_annotation.startIndex > prev_start ? new_annotation.startIndex - prev_start : 0;\r\n\t\t\t\tvar prev_len = prev_end - prev_start;\r\n\t\t\t\tvar endHighlight = new_annotation.endIndex > prev_end ? prev_len : prev_len - (prev_end - new_annotation.endIndex);\r\n\r\n\t\t\t\tnew_annotation.color = colors[this.state.defaultColorInd];\r\n\r\n\t\t\t\treturn [prev_annotation.slice(0,startHighlight),\r\n\t\t\t\t\t\t<AnnotationButton\r\n\t\t\t\t\t\t\tupdater={ this.handleRerender }\r\n\t\t\t\t\t\t\tdeleter={ this.handleDeleteAnnotation }\r\n\t\t\t\t\t\t\tkey={ parseInt(\"\" + new_annotation.id + prev_start + prev_end) }\r\n\t\t\t\t\t\t\tdepth={ new_annotation.depth }\r\n\t\t\t\t\t\t\tannotation={ new_annotation }\r\n\t\t\t\t\t\t\tcolor={ new_annotation.color } >\r\n\t\t\t\t\t\t\t{prev_annotation.slice(startHighlight,endHighlight)}\r\n\t\t\t\t\t\t</AnnotationButton>,\r\n\t\t\t\t\t\tprev_annotation.slice(endHighlight)]\r\n\t\t\t}\r\n\t\t\telse if (prev_annotation.type==='br') {\r\n\t\t\t\treturn [<br key={ prev_annotation.key }></br>]\r\n\t\t\t}\r\n\r\n\t\t\t//Recurse\r\n\t\t\tvar prev_children = prev_annotation.props.children;\r\n\t\t\tif (!Array.isArray(prev_children)){\r\n\t\t\t\tprev_children = [prev_children];\r\n\t\t\t}\r\n\t\t\tvar modified_children = [];\r\n\t\t\tfor (var i=0; i<prev_children.length; i++){\r\n\t\t\t\tprev_end = (typeof prev_children[i] === 'string' || prev_children[i] instanceof String) ?\r\n\t\t\t\t\tprev_start + prev_children[i].length : prev_children[i].props.annotation.endIndex;\r\n\r\n\t\t\t\tmodified_children = modified_children.concat(this.processAnnotation(new_annotation, prev_children[i], prev_start, prev_end));\r\n\r\n\t\t\t\tprev_start = prev_end;\r\n\t\t\t}\r\n\r\n\t\t\treturn [<AnnotationButton\r\n\t\t\t\t\t\tupdater={ this.handleRerender }\r\n\t\t\t\t\t\tdeleter={ this.handleDeleteAnnotation }\r\n\t\t\t\t\t\tkey={ parseInt(\"\" + new_annotation.id + prev_start + prev_end) }\r\n\t\t\t\t\t\tdepth={ prev_annotation.props.depth }\r\n\t\t\t\t\t\tannotation={ prev_annotation.props.annotation }\r\n\t\t\t\t\t\tcolor={ prev_annotation.props.annotation.color }>\r\n\t\t\t\t\t\t{ modified_children }\r\n\t\t\t\t\t</AnnotationButton>];\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn prev_annotation;\r\n\t\t}\r\n\t}\r\n\r\n\thandleAppend() {\r\n\t\tvar newPanes = this.state.textPanes;\r\n\t\tnewPanes.push(\"\" + document.getElementById(\"append-text\").value);\r\n\t\tnewPanes.push(<br key={ parseInt(\"\" + -1 + this.state.text.length + this.state.text.length) }></br>);\r\n\t\tthis.setState({ textPanes : newPanes, text : this.state.text + \"\\n\" + document.getElementById(\"append-text\").value})\r\n\t\tdocument.getElementById(\"append-text\").value = \"\";\r\n\t}\r\n\r\n\thandleAppendEnter(e) {\r\n\t\tif (e.key === \"Enter\") {\r\n\t\t\tthis.handleAppend();\r\n\t\t}\r\n\t}\r\n\r\n\thandleDefaultColor() {\r\n\t\tthis.setState({ defaultColorInd: (this.state.defaultColorInd + 1) % colors.length })\r\n\t}\r\n\r\n\thandleImportReplace() {\r\n\t\tvar newPanes = [];\r\n\t\tnewPanes.push(\"\" + document.getElementById(\"import-text\").value);\r\n\t\tnewPanes.push(<br key={ parseInt(\"\" + -1 + this.state.text.length + this.state.text.length) }></br>);\r\n\t\tthis.setState({\r\n\t\t\tANNOTATIONS: [],\r\n\t\t\tannotation_id: 1,\r\n\t\t\tmaxDepth: 0,\r\n\t\t\ttext: \"\",\r\n\t\t\ttextPanes: newPanes\r\n\t\t});\r\n\t\tdocument.getElementById(\"import-text\").value = \"\";\r\n\t}\r\n\t\r\n\thandleImportAppend() {\r\n\t\tvar newPanes = this.state.textPanes;\r\n\t\tnewPanes.push(\"\" + document.getElementById(\"import-text\").value);\r\n\t\tnewPanes.push(<br key={ parseInt(\"\" + -1 + this.state.text.length + this.state.text.length) }></br>);\r\n\t\tthis.setState({ textPanes : newPanes, text : this.state.text + \"\\n\" + document.getElementById(\"import-text\").value})\r\n\t\tdocument.getElementById(\"import-text\").value = \"\";\r\n\t}\r\n\r\n\thandleClear() {\r\n\t\tthis.setState({\r\n\t\t\t\tANNOTATIONS: [],\r\n\t\t\t\tannotation_id: 1,\r\n\t\t\t\tkeys: 1,\r\n\t\t\t\tmaxDepth: 0,\r\n\t\t\t\ttext: \"\",\r\n\t\t\t\ttextPanes: []\r\n\t\t\t});\r\n\t}\r\n\r\n\tonSetSidebarOpen(open) {\r\n\t\tthis.setState({ sidebarOpen: open })\r\n\t}\r\n\r\n\trender() {\r\n\t\tvar textbody = (\r\n\t\t\t<div>\r\n\t\t\t\t<div id=\"textbody\" onMouseUp={this.handleMouseUp}>\r\n\t\t\t\t\t{ this.state.textPanes }\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\r\n\t\tvar sidebarContent =\r\n\t\t\t<div className=\"sideNav\">\r\n\t\t\t\t<p className=\"menuItem\"  onClick={ this.handleExample }> Example </p>\r\n\t\t\t\t<p className=\"menuItem\"  onClick={ this.handleShowImport }> Bulk Plaintext { this.state.isShowImport ? <FaChevronCircleUp/> : <FaChevronCircleDown/> }</p>\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.state.isShowImport &&\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<textarea id=\"import-text\" style={ {width:\"100%\", fontSize: \"0.75em\", height:\"12em\"} } placeholder=\"Enter text to input.\">\r\n\t\t\t\t\t\t</textarea>\r\n\t\t\t\t\t\t<button style={ {width:\"50%\", fontSize: \"0.75em\"} } onClick={this.handleImportReplace} type=\"button\">Replace</button>\r\n\t\t\t\t\t\t<button style={ {width:\"50%\", fontSize: \"0.75em\"} } onClick={this.handleImportAppend} type=\"button\">Append</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t\t<p className=\"menuItem\"  onClick={ this.handleShowExportAnnotations }> Export Annotations { this.state.isShowExportAnnotations ? <FaChevronCircleUp/> : <FaChevronCircleDown/> }</p>\r\n\t\t\t\t{\r\n\t\t\t\t\t this.state.isShowExportAnnotations &&\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<textarea id=\"export-annotations\" style={ {width:\"100%\", fontSize: \"0.75em\", height:\"12em\"} } readOnly value={ Buffer.from(JSON.stringify(this.state)).toString(\"base64\") }>\r\n\t\t\t\t\t\t</textarea>\r\n\t\t\t\t\t\t<a href={ 'data:text/plain;charset=utf-8,' + Buffer.from(JSON.stringify(this.state)).toString(\"base64\") } download={ \"LangAnnotator.txt\" }>\r\n\t\t\t\t\t\t\t<button style={ {width:\"100%\", fontSize: \"0.75em\"} } type=\"button\">Save as File</button>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t\t<p className=\"menuItem\"  onClick={ this.handleShowImportAnnotations }> Import Annotations { this.state.isShowImportAnnotations ? <FaChevronCircleUp/> : <FaChevronCircleDown/> } </p>\r\n\t\t\t\t{\r\n\t\t\t\t\t this.state.isShowImportAnnotations &&\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<textarea id=\"import-annotations\" style={ {width:\"100%\", fontSize: \"0.75em\", height:\"12em\"} }>\r\n\t\t\t\t\t\t</textarea>\r\n\t\t\t\t\t\t<button style={ {width:\"50%\", fontSize: \"0.75em\"} } onClick={this.handleImportAnnotations} type=\"button\">Load</button>\r\n\t\t\t\t\t\t<button style={ {width:\"50%\", fontSize: \"0.75em\"} } onClick={this.handleStartFileUpload} type=\"button\">File Import</button>\r\n\t\t\t\t\t\t<input type=\"file\" id=\"annotationFileInput\" className=\"annotationImport\" onChange={(e) => this.handleImportFileAnnotations(e)} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t\t<p className=\"menuItem\"  onClick={ this.handleShowHelp }> Help { this.state.isShowHelp ? <FaChevronCircleUp/> : <FaChevronCircleDown/> }</p>\r\n\t\t\t\t{ \r\n\t\t\t\t\tthis.state.isShowHelp &&\r\n\t\t\t\t\t<div style={{fontSize: \"0.75em\", padding: \"0 0.25em\"}}>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\t<b>Highlight</b> a part of the text to add an annotation.\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\t<b>Click</b> an annotation to view it or modify it.\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\tUse the top <b>Append</b> bar to add another line to the main text body. Use the <b>Import Plaintext</b> option to append large blocks of text.\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\tClick on the <b>trash can</b> to clear the body of text.\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p> \r\n\t\t\t\t\t\tSave the state of your notebook from <b>Export Annotations</b> and reload it using <b>Import Annotations</b>.\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>}\r\n\t\t\t</div>\r\n\r\n\t    return (\r\n\t    \t\t<Sidebar sidebar={ sidebarContent }\r\n\t\t\t        \topen={this.state.sidebarOpen}\r\n\t\t\t        \tonSetOpen={this.onSetSidebarOpen}\r\n\t\t\t        \tstyles={{ sidebar: { background: \"white\", width: \"25%\" } }}>\r\n     \t\t\t\t<div className=\"topNav\">\r\n\t     \t\t\t\t<div className=\"menuBar\">\r\n\t\t     \t\t\t\t<button style={{ minHeight: \"2em\" }} onClick={() => this.onSetSidebarOpen(true)}>\r\n\t    \t     \t\t\t\t<FaBars/>\r\n\t        \t\t\t\t</button>\r\n\t        \t\t\t\t<span>\r\n\t        \t\t\t\t\tLangAnnotator\r\n\t        \t\t\t\t</span>\r\n\t\t\t    \t\t</div>\r\n\t\t\t\t\t\t<div className=\"nav-append\">\r\n\t\t\t\t\t\t\t<input type=\"text\" id=\"append-text\" onKeyUp={ this.handleAppendEnter }></input>\r\n\t\t\t\t\t\t\t<span className=\"dot-bg\">\r\n\t\t\t\t\t\t\t\t<span className=\"dot\" style={{ backgroundColor: colors[this.state.defaultColorInd] }} onClick={this.handleDefaultColor}></span>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<button onClick={this.handleAppend} type=\"button\">Append</button>\r\n\t\t\t\t\t\t\t<button onClick={this.handleClear} type=\"button\"><FaTrash/></button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div style={{ visibility: \"hidden\" }}>\r\n\t     \t\t\t\t<div className=\"menuBar\">\r\n\t\t     \t\t\t\t<button style={{ minHeight: \"2em\" }} onClick={() => this.onSetSidebarOpen(true)}>\r\n\t    \t     \t\t\t\t<FaBars/>\r\n\t        \t\t\t\t</button>\r\n\t        \t\t\t\t<span>\r\n\t        \t\t\t\t\tLangAnnotator\r\n\t        \t\t\t\t</span>\r\n\t\t\t    \t\t</div>\r\n\t\t\t\t\t\t<div className=\"nav-append\">\r\n\t\t\t\t\t\t\t<input type=\"text\" id=\"append-teaxt\" onKeyUp={ this.handleAppendEnter }></input>\r\n\t\t\t\t\t\t\t<button onClick={this.handleAppend} type=\"button\">Append</button>\r\n\t\t\t\t\t\t\t<button onClick={this.handleClear} type=\"button\"><FaTrash/></button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t    \t\t{ textbody }\r\n\t    \t\t</Sidebar>\r\n\t    \t);\r\n\t}\r\n\r\n\thandleExample() {\r\n\t\tvar a1 = new Annotation(1, 19, 27, \"cambiar - verb\\nto change\");\r\n\t\ta1.id = 1;\r\n\t\ta1.color = colors[1];\r\n\t\tvar a2 = new Annotation(1, 42, 46, \"emos/amos indicates that the pronoun is \\\"us\\\"\");\r\n\t\ta2.id = 2;\r\n\t\ta2.color = colors[0];\r\n\t\tvar a3 = new Annotation(1, 99, 105, \"cambiar\");\r\n\t\ta3.id = 3;\r\n\t\ta3.color = colors[1];\r\n\t\tvar a4 = new Annotation(1, 146, 162, \"Guatemalan activist and Nobel Peace prize winner\");\r\n\t\ta4.id = 4;\r\n\t\ta4.color = colors[3];\r\n\r\n\t\tthis.setState({\r\n\t\t\tANNOTATIONS: [a1, a2, a3, a4],\r\n\t\t\tannotation_id: 5,\r\n\t\t\tmaxDepth: 1,\r\n\t\t\ttext: \"Este mundo no va a cambiar a menos que estemos dispuestos a cambiar nosotros mismos\\nThe world won't change unless we're willing to change ourselves\\nRigoberta Menchu\",\r\n\t\t\ttextPanes:\r\n\t\t\t\t[\"Este mundo no va a \",\r\n\t\t\t\t<AnnotationButton\r\n\t\t\t\t\t\tupdater={ this.handleRerender }\r\n\t\t\t\t\t\tdeleter={ this.handleDeleteAnnotation }\r\n\t\t\t\t\t\tkey={ parseInt(\"\" + a1.id + a1.startIndex + a1.endIndex) }\r\n\t\t\t\t\t\tdepth={ a1.depth }\r\n\t\t\t\t\t\tannotation={ a1 }\r\n\t\t\t\t\t\tcolor={ a1.color }>\r\n\t\t\t\t\t\tcambiar\r\n\t\t\t\t\t</AnnotationButton>,\r\n\t\t\t\t\" a menos que est\",\r\n\t\t\t\t<AnnotationButton\r\n\t\t\t\t\t\tupdater={ this.handleRerender }\r\n\t\t\t\t\t\tdeleter={ this.handleDeleteAnnotation }\r\n\t\t\t\t\t\tkey={ parseInt(\"\" + a2.id + a2.startIndex + a2.endIndex) }\r\n\t\t\t\t\t\tdepth={ a2.depth }\r\n\t\t\t\t\t\tannotation={ a2 }\r\n\t\t\t\t\t\tcolor={ a2.color }>\r\n\t\t\t\t\t\temos\r\n\t\t\t\t\t</AnnotationButton>,\r\n\t\t\t\t\" dispuestos a cambiar nosotros mismos\",\r\n\t\t\t\t<br key={1}></br>,\r\n\t\t\t\t\"The world won't \",\r\n\t\t\t\t<AnnotationButton\r\n\t\t\t\t\t\tupdater={ this.handleRerender }\r\n\t\t\t\t\t\tdeleter={ this.handleDeleteAnnotation }\r\n\t\t\t\t\t\tkey={ parseInt(\"\" + a3.id + a3.startIndex + a3.endIndex) }\r\n\t\t\t\t\t\tdepth={ a3.depth }\r\n\t\t\t\t\t\tannotation={ a3 }\r\n\t\t\t\t\t\tcolor={ a3.color }>\r\n\t\t\t\t\t\tchange\r\n\t\t\t\t\t</AnnotationButton>,\r\n\t\t\t\t \" unless we're willing to change ourselves\",\r\n\t\t\t\t <br key={2}></br>,\r\n\t\t\t\t \"\",\r\n\t\t\t\t <AnnotationButton\r\n\t\t\t\t\t\tupdater={ this.handleRerender }\r\n\t\t\t\t\t\tdeleter={ this.handleDeleteAnnotation }\r\n\t\t\t\t\t\tkey={ parseInt(\"\" + a4.id + a4.startIndex + a4.endIndex) }\r\n\t\t\t\t\t\tdepth={ a4.depth }\r\n\t\t\t\t\t\tannotation={ a4 }\r\n\t\t\t\t\t\tcolor={ a4.color }>\r\n\t\t\t\t\t\tRigoberta Menchu\r\n\t\t\t\t\t</AnnotationButton>,\r\n\t\t\t\t \"\",\r\n\t\t\t\t <br key={3}></br>]\r\n\t\t});\r\n\t\tthis.setState();\r\n\t}\r\n\r\n\thandleShowHelp() {\r\n\t\tthis.setState({ isShowHelp: !this.state.isShowHelp });\r\n\t}\r\n\r\n\thandleShowImport() {\r\n\t\tthis.setState({ isShowImport: !this.state.isShowImport });\r\n\t}\r\n\r\n\thandleShowImportAnnotations() {\r\n\t\tthis.setState({ isShowImportAnnotations: !this.state.isShowImportAnnotations });\r\n\t}\r\n\r\n\thandleShowExportAnnotations() {\r\n\t\tthis.setState({ isShowExportAnnotations: !this.state.isShowExportAnnotations });\r\n\t}\r\n\r\n\thandleImportAnnotations() {\r\n\t\tlet encodedAnnotations = document.getElementById(\"import-annotations\").value;\r\n\t\tvar annotations = JSON.parse(Buffer.from(encodedAnnotations, \"base64\").toString(\"utf-8\"));\r\n\t\tannotations.ANNOTATIONS = this.regenerateAnnotations(annotations.ANNOTATIONS);\r\n\t\tannotations.textPanes = this.regenerateTextPanes(annotations.textPanes, annotations.ANNOTATIONS);\r\n\t\tthis.setState(annotations);\r\n\t}\r\n\r\n\thandleImportFileAnnotations = async (e) => {\r\n\t\te.preventDefault()\r\n\t\tconst reader = new FileReader()\r\n\t\treader.onload = async (e) => { \r\n\t    \tconst text = (e.target.result);\r\n\t    \tdocument.getElementById(\"import-annotations\").value = text;\r\n\t    };\r\n\t    reader.readAsText(e.target.files[0]);\r\n\t}\r\n\r\n\thandleStartFileUpload() {\r\n\t\tdocument.getElementById(\"annotationFileInput\").click();\r\n\t}\r\n\r\n\tregenerateAnnotations(annotations) {\r\n\t\tvar regenerated = []\r\n\t\tvar temp;\r\n\t\tfor (var i=0; i<annotations.length; i++){\r\n\t\t\ttemp = new Annotation(annotations[i]._depth, annotations[i]._start, annotations[i]._end, annotations[i]._description);\r\n\t\t\ttemp.id = annotations[i]._id; \r\n\t\t\ttemp.color = annotations[i]._color;\r\n\t\t\tregenerated.push(temp)\r\n\t\t}\r\n\t\treturn regenerated;\r\n\t}\r\n\r\n\tregenerateTextPanes(annotations, ann_refs) {\r\n\t\tvar regenerated = [];\r\n\t\tfor (var i=0; i<annotations.length; i++){\r\n\t\t\tif (typeof annotations[i] === 'string' || annotations[i] instanceof String) {\r\n\t\t\t\tregenerated.push(annotations[i]);\r\n\t\t\t}\r\n\t\t\telse if (annotations[i].type === \"br\") {\r\n\t\t\t\tregenerated.push(<br key={ annotations[i].key }></br>);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tregenerated.push(\r\n\t\t\t\t\t<AnnotationButton\r\n\t\t\t\t\t\tupdater={ this.handleRerender }\r\n\t\t\t\t\t\tdeleter={ this.handleDeleteAnnotation }\r\n\t\t\t\t\t\tkey={ annotations[i].key }\r\n\t\t\t\t\t\tdepth={ annotations[i].props.depth }\r\n\t\t\t\t\t\tannotation={ ann_refs[annotations[i].props.annotation._id - 1] }\r\n\t\t\t\t\t\tcolor={ annotations[i].props.annotation.color }>\r\n\t\t\t\t\t\t{ Array.isArray(annotations[i].props.children) ? \r\n\t\t\t\t\t\t\tthis.regenerateTextPanes(annotations[i].props.children, ann_refs) :\r\n\t\t\t\t\t\t\tthis.regenerateTextPanes([annotations[i].props.children], ann_refs)[0] }\r\n\t\t\t\t\t</AnnotationButton>);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn regenerated;\r\n\t}\r\n\r\n}","import React from 'react';\r\n\r\nimport MainText from './MainText';\r\n\r\nexport default class MainPage extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tisExample: true,\r\n\t\t\tsidebarOpen: false\r\n\t\t};\r\n\t\tthis.onSetSidebarOpen = this.onSetSidebarOpen.bind(this);\r\n\t\tthis.handleExample = this.handleExample.bind(this);\r\n\t}\r\n\r\n\tonSetSidebarOpen(open) {\r\n\t\tthis.setState({ sidebarOpen: open })\r\n\t}\r\n\r\n\thandleExample() {\r\n\t\tthis.setState({ isExample: true });\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn <MainText></MainText>;\r\n\t\t/*\r\n\t    return (\r\n\t    \t<div>\r\n\t    \t\t<Sidebar sidebar={ sidebarContent }\r\n\t\t\t        \topen={this.state.sidebarOpen}\r\n\t\t\t        \tonSetOpen={this.onSetSidebarOpen}\r\n\t\t\t        \tstyles={{ sidebar: { background: \"white\", width: \"10em\"} }}>\r\n     \t\t\t\t\r\n     \t\t\t\t<div className=\"menuBar\">\t\r\n\t     \t\t\t\t<button style={{ minHeight: \"2em\" }} onClick={() => this.onSetSidebarOpen(true)}>\r\n    \t     \t\t\t\t<FaBars/>\r\n        \t\t\t\t</button>\r\n        \t\t\t\t<span>\r\n        \t\t\t\t\tLangAnnotator\r\n        \t\t\t\t</span>\r\n\t\t    \t\t</div>\r\n\r\n\t\t    \t\t<MainText runExample={ this.state.isExample }></MainText>\r\n\r\n\t    \t\t</Sidebar>\r\n\t    \t</div>);\r\n\t    */\r\n\t}\r\n}","import React from 'react';\n//import logo from './logo.svg';\n\nimport MainPage from './components/MainPage';\n\nimport './App.css';\nimport './components/TextBody.css';\n\nfunction App() {\n  return (\n    <MainPage></MainPage>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import React from 'react';\r\nimport { FaPen, FaTrash } from 'react-icons/fa'\r\n\r\nimport './Annotation.css'\r\nimport './TextBody.css'\r\n\r\nconst colors = [\r\n\t\"#e88\", //red\r\n\t\"#ec5\", //orange\r\n\t\"#7a5\", //green\r\n\t\"#48f\", //blue\r\n\t\"#99e\", //violet\r\n\t\"#e9d\" //pink\r\n]\r\n\r\nexport default class AnnotationButton extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tisShowing: false,\r\n\t\t\tisHighlighted: false,\r\n\t\t\tcolor: this.props.color,\r\n\t\t\tisEditing: false\r\n\t\t}\r\n\t\tthis.handleDeleter = this.handleDeleter.bind(this);\r\n\t\tthis.handleOnShow = this.handleOnShow.bind(this);\r\n\t\tthis.handleOnClose = this.handleOnClose.bind(this);\r\n\t\tthis.handleColorChange = this.handleColorChange.bind(this);\r\n\t\tthis.handleHover = this.handleHover.bind(this);\r\n\t\tthis.handleEditMode = this.handleEditMode.bind(this);\r\n\t\tthis.handleViewMode = this.handleViewMode.bind(this);\r\n\t\tthis.handleViewModeReset = this.handleViewModeReset.bind(this);\r\n\t}\r\n\r\n\thandleHover() {\r\n\t}\r\n\r\n\thandleDeleter() {\r\n\t\tthis.props.deleter(this)\r\n\t}\r\n\r\n\thandleColorChange(c) {\r\n\t\tthis.setState({color: c});\r\n\t\tthis.props.annotation.color = c;\r\n\t\tthis.props.updater(this.props.annotation, c);\r\n\t}\r\n\r\n\thandleOnShow() {\r\n\t\tif (!this.state.isShowing){\r\n\t\t\tthis.setState({ isShowing: true });\r\n\t\t}\r\n\t}\r\n\r\n\thandleOnClose(e) {\r\n\t\tif (document.getElementsByClassName(\"modal\").length && \r\n\t\t\t!document.getElementsByClassName(\"modal\")[0].contains(e.target)){\r\n\t\t\tthis.setState({ isShowing: false });\r\n\t\t}\r\n\t\te.stopPropagation();\r\n\t}\r\n\r\n\thandleEditMode() {\r\n\t\tthis.setState({ isEditing : !this.state.isEditing });\r\n\t}\r\n\r\n\thandleViewMode() {\r\n\t\tthis.props.annotation.description = document.getElementById(\"updatedDescription\").value;\r\n\t\tthis.setState({ isEditing : !this.state.isEditing });\r\n\t}\r\n\r\n\thandleViewModeReset() {\r\n\t\tdocument.getElementById(\"updatedDescription\").value = this.props.annotation.description;\r\n\t\tthis.setState({ isEditing : !this.state.isEditing });\r\n\t}\r\n\r\n\trender() {\r\n\t\tlet color_buttons = colors.map((c) => <span onClick={ () => this.handleColorChange(c) } \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"color-selector\" \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={c} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{backgroundColor: c}}></span>)\r\n\t\treturn (\r\n\t\t\t<span>\r\n\t\t\t\t<span className={ this.state.isHighlighted ? \"annotation-btn\" : \"annotation-btn\"} \r\n\t\t\t\t\tonMouseOver={ this.handleHover }\r\n\t\t\t\t\tonClick={ this.handleOnShow }\r\n\t\t\t\t\tstyle={ {background: `linear-gradient(0deg, ${this.props.annotation.color}, white 1px, transparent 1px)`,\r\n\t\t\t\t\t\t\tlineHeight: `${20+(this.props.depth-1)}px`,\r\n\t\t\t\t\t\t\tpaddingBottom: `${4*(this.props.depth-1)}px`,\r\n\t\t\t\t\t\t\tcolor: this.props.annotation.color} }>\r\n\t\t\t\t{ this.props.children }\r\n\t\t\t\t</span>\r\n\t\t\t\t{ \r\n\t\t\t\t\tthis.state.isShowing && \r\n\t\t\t\t\t<div className=\"modal-bg\" onClick={ this.handleOnClose } style={ {color: \"black\"} }>\r\n\t\t\t\t\t\t<div className=\"modal\">\r\n\t\t\t\t\t\t<div className=\"modal-inner\">\r\n\t\t\t\t\t\t\t<div className=\"modal-header\">\r\n\t\t\t\t\t\t\t\t{ color_buttons }\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<hr></hr>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t!this.state.isEditing &&\r\n\t\t\t\t\t\t\t\t<div className=\"modal-desc\">\r\n\t\t\t\t\t\t\t\t\t<span className=\"modal-desc-text\">\r\n\t\t\t\t\t\t\t\t\t\t{ this.props.annotation.description }\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t<br></br>\r\n\t\t\t\t\t\t\t\t\t<div className=\"optionsBar\">\r\n\t\t\t\t\t\t\t\t\t<span className=\"lowOptions\" onClick={ this.handleEditMode } size={5}>\r\n\t\t\t\t\t\t\t\t\t\t<FaPen/>\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t<span className=\"lowOptions\" onClick={ this.handleDeleter } size={5}>\r\n\t\t\t\t\t\t\t\t\t\t<FaTrash/>\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</div>\t\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tthis.state.isEditing &&\r\n\t\t\t\t\t\t\t\t<div className=\"modal-desc\">\r\n\t\t\t\t\t\t\t\t\t<textarea id=\"updatedDescription\" defaultValue={ this.props.annotation.description }></textarea>\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<button class=\"modal-submit\" type=\"button\" onClick={ this.handleViewMode }>Update Description</button>\r\n\t\t\t\t\t\t\t\t\t<button class=\"modal-reset\" type=\"button\" onClick={ this.handleViewModeReset }>Cancel</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t</span>\r\n\t\t);\r\n\t}\r\n}","export default class Annotation {\r\n\tconstructor(depth=1, startIndex=0, endIndex=0, description=\"\") {\r\n\t\tthis._groups = [];\r\n\t\tthis.depth = depth;;\r\n\t\tthis.startIndex = startIndex;\r\n\t\tthis.endIndex = endIndex;\r\n\t\tthis.description = description;\r\n\t}\r\n\t//MUTATORS\r\n\tset id(id) {\r\n\t\tthis._id = id;\r\n\t}\r\n\tset groups(nodes) {\r\n\t\tthis._groups = nodes;\r\n\t}\r\n\tset startIndex(start) {\r\n\t\tthis._start = start;\r\n\t}\r\n\tset endIndex(end) {\r\n\t\tthis._end = end;\r\n\t}\r\n\tset depth(depth) {\r\n\t\tthis._depth = depth;\r\n\t}\r\n\tset title(title) {\r\n\t\tthis._title = title;\r\n\t}\r\n\tset description(desc) {\r\n\t\tthis._description = desc;\r\n\t}\r\n\tset selection(sel) {\r\n\t\tthis._selection = sel;\r\n\t}\r\n\tset color(color) {\r\n\t\tthis._color = color;\r\n\t}\r\n\t// ACCESSORS\r\n\tget id() {\r\n\t\treturn this._id;\r\n\t}\r\n\tget groups() {\r\n\t\treturn this._groups;\r\n\t}\r\n\tget startIndex() {\r\n\t\treturn this._start;\r\n\t}\r\n\tget endIndex() {\r\n\t\treturn this._end;\r\n\t}\r\n\tget depth() {\r\n\t\treturn this._depth;\r\n\t}\r\n\tget title() {\r\n\t\treturn this._title;\r\n\t}\r\n\tget description() {\r\n\t\treturn this._description;\r\n\t}\r\n\tget selection() {\r\n\t\treturn this._selection;\r\n\t}\r\n\tget color() {\r\n\t\treturn this._color;\r\n\t}\r\n}"],"sourceRoot":""}