(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{14:function(e,t,n){e.exports=n(27)},19:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(12),s=n.n(o),r=(n(19),n(3)),l=n(4),d=n(7),c=n(5),h=n(1),p=n(8),u=n(10),m=n(6),g=function(){function e(){Object(r.a)(this,e),this._groups=[]}return Object(l.a)(e,[{key:"id",set:function(e){this._id=e},get:function(){return this._id}},{key:"groups",set:function(e){this._groups=e},get:function(){return this._groups}},{key:"startIndex",set:function(e){this._start=e},get:function(){return this._start}},{key:"endIndex",set:function(e){this._end=e},get:function(){return this._end}},{key:"depth",set:function(e){this._depth=e},get:function(){return this._depth}},{key:"title",set:function(e){this._title=e},get:function(){return this._title}},{key:"description",set:function(e){this._description=e},get:function(){return this._description}},{key:"selection",set:function(e){this._selection=e},get:function(){return this._selection}},{key:"color",set:function(e){this._color=e},get:function(){return this._color}}]),e}(),b=(n(24),["#e88","#ec5","#7a5","#48f","#99e","#e9d"]),f=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(d.a)(this,Object(c.a)(t).call(this,e))).state={isShowing:!1,isHighlighted:!1,color:n.props.color,isEditing:!1},n.handleOnShow=n.handleOnShow.bind(Object(h.a)(n)),n.handleOnClose=n.handleOnClose.bind(Object(h.a)(n)),n.handleColorChange=n.handleColorChange.bind(Object(h.a)(n)),n.handleHover=n.handleHover.bind(Object(h.a)(n)),n.handleEditMode=n.handleEditMode.bind(Object(h.a)(n)),n.handleViewMode=n.handleViewMode.bind(Object(h.a)(n)),n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"handleHover",value:function(){}},{key:"handleColorChange",value:function(e){this.setState({color:e}),this.props.annotation.color=e,this.props.updater(this.props.annotation,e)}},{key:"handleOnShow",value:function(){this.state.isShowing||this.setState({isShowing:!0})}},{key:"handleOnClose",value:function(e){document.getElementsByClassName("modal").length&&!document.getElementsByClassName("modal")[0].contains(e.target)&&this.setState({isShowing:!1}),e.stopPropagation()}},{key:"handleEditMode",value:function(){this.setState({isEditing:!this.state.isEditing})}},{key:"handleViewMode",value:function(){this.props.annotation.description=document.getElementById("updatedDescription").value,this.setState({isEditing:!this.state.isEditing})}},{key:"render",value:function(){var e=this,t=b.map((function(t){return i.a.createElement("span",{onClick:function(){return e.handleColorChange(t)},className:"color-selector",key:t,style:{backgroundColor:t}})}));return i.a.createElement("span",null,i.a.createElement("span",{className:(this.state.isHighlighted,"annotation-btn"),onMouseOver:this.handleHover,onClick:this.handleOnShow,style:{background:"linear-gradient(0deg, ".concat(this.props.annotation.color,", white 1px, transparent 1px)"),lineHeight:this.props.depth-1+20+"px",paddingBottom:4*(this.props.depth-1)+"px",color:this.props.annotation.color}},this.props.children),this.state.isShowing&&i.a.createElement("div",{className:"modal-bg",onClick:this.handleOnClose,style:{color:"black"}},i.a.createElement("div",{className:"modal"},i.a.createElement("div",{className:"modal-inner"},i.a.createElement("div",{className:"modal-header"},t),i.a.createElement("hr",null),!this.state.isEditing&&i.a.createElement("div",{className:"modal-desc"},i.a.createElement("span",{className:"modal-desc-text"},this.props.annotation.description),i.a.createElement("br",null),i.a.createElement("span",{className:"lowOptions",onClick:this.handleEditMode,size:5},i.a.createElement(m.b,null))),this.state.isEditing&&i.a.createElement("div",{className:"modal-desc"},i.a.createElement("textarea",{id:"updatedDescription",defaultValue:this.props.annotation.description}),i.a.createElement("button",{type:"button",onClick:this.handleViewMode},"Update Description"))))))}}]),t}(i.a.Component),x=["#e88","#ec5","#7a5","#48f","#99e","#e9d"],E=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(d.a)(this,Object(c.a)(t).call(this,e))).state={ANNOTATIONS:[],annotation_id:1,keys:1,maxDepth:0,text:"",textPanes:[],isShowHelp:!1},n.handleMouseUp=n.handleMouseUp.bind(Object(h.a)(n)),n.handleRerender=n.handleRerender.bind(Object(h.a)(n)),n.handleAppend=n.handleAppend.bind(Object(h.a)(n)),n.handleAppendEnter=n.handleAppendEnter.bind(Object(h.a)(n)),n.handleClear=n.handleClear.bind(Object(h.a)(n)),n.onSetSidebarOpen=n.onSetSidebarOpen.bind(Object(h.a)(n)),n.handleExample=n.handleExample.bind(Object(h.a)(n)),n.handleShowHelp=n.handleShowHelp.bind(Object(h.a)(n)),n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"handleRerender",value:function(e,t){this.reloadTextPanes(this.state.textPanes,e,t)}},{key:"reloadTextPanes",value:function(e,t,n){for(var a=0;a<e.length;a++)if(e[a].props&&e[a].props.children){var o=e[a].props.children;Array.isArray(o)||(o=[o]),this.reloadTextPanes(o,t,n),e[a]=i.a.createElement(f,{updater:this.handleRerender,key:e[a].key,depth:e[a].props.depth,annotation:e[a].props.annotation,color:e[a].props.annotation==t?n:e[a].props.annotation.color},o)}this.setState(this.state)}},{key:"handleMouseUp",value:function(){if(!document.getElementsByClassName("modal").length&&document.getSelection()&&document.getSelection().toString().length>0){var e=document.getSelection(),t=this.getUserInput(),n=new g;n.description=t,n.selection=e,this.styleSelection(e,n,"textbody"),e.empty()}}},{key:"getUserInput",value:function(){return window.prompt("What is this annotation for?","")}},{key:"styleSelection",value:function(e,t,n){if(t.id=this.state.annotation_id,t.startIndex=this.getTotalOffset(e.anchorNode,e.anchorOffset,n),t.endIndex=this.getTotalOffset(e.focusNode,e.focusOffset,n),t.startIndex>t.endIndex){var a=t.startIndex;t.startIndex=t.endIndex,t.endIndex=a}var i=this.getDepthRange(t);t.depth=i,this.setState({maxDepth:Math.max(this.state.maxDepth,i)});for(var o=[],s=0,r=this.state.text.length,l=0;l<this.state.textPanes.length;l++){r="string"==typeof this.state.textPanes[l]||this.state.textPanes[l]instanceof String?s+this.state.textPanes[l].length:"br"==this.state.textPanes[l].type?s:this.state.textPanes[l].props.annotation.endIndex;var d=this.processAnnotation(t,this.state.textPanes[l],s,r);o=o.concat(d),s=r}this.setState({textPanes:o}),this.setState({annotation_id:this.state.annotation_id+1}),this.state.ANNOTATIONS.push(t)}},{key:"getDepthRange",value:function(e){for(var t=[],n=0;n<this.state.maxDepth+1;n++)t.push(n+1);var a=!0,i=!1,o=void 0;try{for(var s,r=this.state.ANNOTATIONS[Symbol.iterator]();!(a=(s=r.next()).done);a=!0){var l=s.value;l.startIndex<e.endIndex&&e.startIndex<l.endIndex&&(t[l.depth-1]=-1)}}catch(p){i=!0,o=p}finally{try{a||null==r.return||r.return()}finally{if(i)throw o}}for(var d=0,c=t;d<c.length;d++){var h=c[d];if(h>0)return h}return this.state.maxDepth+1}},{key:"getTotalOffset",value:function(e,t,n){for(var a=/(\t|\n|\r)+/,i=t-(e.textContent.substring(0,t).length-e.textContent.substring(0,t).replace(a,"").length),o=e;o!==document.getElementById(n);)null!==o.previousSibling?i+=(o=o.previousSibling).textContent.replace(a,"").length:o=o.parentNode;return i}},{key:"processAnnotation",value:function(e,t,n,a){if(e.startIndex<a&&n<e.endIndex){if("string"==typeof t||t instanceof String){var o=e.startIndex>n?e.startIndex-n:0,s=a-n,r=e.endIndex>a?s:s-(a-e.endIndex);return e.color=x[0],[t.slice(0,o),i.a.createElement(f,{updater:this.handleRerender,key:parseInt(""+e.id+n+a),depth:e.depth,annotation:e,color:e.color},t.slice(o,r)),t.slice(r)]}if("br"==t.type)return[i.a.createElement("br",{key:t.key})];var l=t.props.children;Array.isArray(l)||(l=[l]);for(var d=[],c=0;c<l.length;c++)a="string"==typeof l[c]||l[c]instanceof String?n+l[c].length:l[c].props.annotation.endIndex,d=d.concat(this.processAnnotation(e,l[c],n,a)),n=a;return[i.a.createElement(f,{updater:this.handleRerender,key:parseInt(""+e.id+n+a),depth:t.props.depth,annotation:t.props.annotation,color:t.props.annotation.color},d)]}return t}},{key:"handleAppend",value:function(){var e=this.state.textPanes;e.push(""+document.getElementById("append-text").value),e.push(i.a.createElement("br",{key:parseInt("-1"+this.state.text.length+this.state.text.length)})),this.setState({textPanes:e,text:this.state.text+"\n"+document.getElementById("append-text").value}),document.getElementById("append-text").value=""}},{key:"handleAppendEnter",value:function(e){"Enter"==e.key&&this.handleAppend()}},{key:"handleClear",value:function(){this.setState({ANNOTATIONS:[],annotation_id:1,keys:1,maxDepth:0,text:"",textPanes:[]})}},{key:"onSetSidebarOpen",value:function(e){this.setState({sidebarOpen:e})}},{key:"render",value:function(){var e=this;console.log(this.state.ANNOTATIONS),console.log(this.state.textPanes);var t=i.a.createElement("div",null,i.a.createElement("div",{className:"nav-append"},i.a.createElement("input",{type:"text",id:"append-text",onKeyUp:this.handleAppendEnter}),i.a.createElement("button",{onClick:this.handleAppend,type:"button"},"Append"),i.a.createElement("button",{onClick:this.handleClear,type:"button"},i.a.createElement(m.c,null))),i.a.createElement("div",{id:"textbody",onMouseUp:this.handleMouseUp},this.state.textPanes)),n=i.a.createElement("div",{className:"sideNav"},i.a.createElement("a",{className:"menuItem",href:"#",onClick:this.handleExample}," Example "),i.a.createElement("a",{className:"menuItem",href:"#",onClick:this.handleShowHelp}," Help "),this.state.isShowHelp&&i.a.createElement("div",{style:{fontSize:"0.75em",padding:"0 0.25em"}},i.a.createElement("p",null,i.a.createElement("b",null,"Highlight")," a part of the text to add an annotation."),i.a.createElement("p",null,i.a.createElement("b",null,"Click")," an annotation to view it or modify it."),i.a.createElement("p",null,"Use the top ",i.a.createElement("b",null,"Append")," bar to add another line to the main text body."),i.a.createElement("p",null,"Click on the ",i.a.createElement("b",null,"trash can")," to clear the body of text.")));return i.a.createElement("div",null,i.a.createElement(u.a,{sidebar:n,open:this.state.sidebarOpen,onSetOpen:this.onSetSidebarOpen,styles:{sidebar:{background:"white",width:"10em"}}},i.a.createElement("div",{className:"menuBar"},i.a.createElement("button",{style:{minHeight:"2em"},onClick:function(){return e.onSetSidebarOpen(!0)}},i.a.createElement(m.a,null)),i.a.createElement("span",null,"LangAnnotator")),t))}},{key:"handleExample",value:function(){var e=new g;e.id=1,e.color=x[1],e.depth=1,e.startIndex=19,e.endIndex=27,e.description="cambiar - verb\nto change";var t=new g;t.id=2,t.color=x[0],t.depth=1,t.startIndex=19,t.endIndex=27,t.description='emos/amos indicates that the pronoun is "us"';var n=new g;n.id=3,n.color=x[1],n.depth=1,n.startIndex=42,n.endIndex=46,n.description="cambiar";var a=new g;a.id=4,a.color=x[3],a.depth=1,a.startIndex=146,a.endIndex=162,a.description="Guatemalan activist and Nobel Peace prize winner",this.setState({ANNOTATIONS:[e,t,n,a],annotation_id:5,keys:2,maxDepth:1,text:"Este mundo no va a cambiar a menos que estemos dispuestos a cambiar nosotros mismos\nThe world won't change unless we're willing to change ourselves\nRigoberta Menchu",textPanes:["Este mundo no va a ",i.a.createElement(f,{updater:this.handleRerender,key:parseInt(""+e.id+e.startIndex+e.endIndex),depth:e.depth,annotation:e,color:e.color},"cambiar")," a menos que est",i.a.createElement(f,{updater:this.handleRerender,key:parseInt(""+t.id+t.startIndex+t.endIndex),depth:t.depth,annotation:t,color:t.color},"emos")," dispuestos a cambiar nosotros mismos",i.a.createElement("br",null),"The world won't ",i.a.createElement(f,{updater:this.handleRerender,key:parseInt(""+n.id+n.startIndex+n.endIndex),depth:n.depth,annotation:n,color:n.color},"change")," unless we're willing to change ourselves",i.a.createElement("br",null),"",i.a.createElement(f,{updater:this.handleRerender,key:parseInt(""+a.id+a.startIndex+a.endIndex),depth:a.depth,annotation:a,color:a.color},"Rigoberta Menchu"),"",i.a.createElement("br",null)]})}},{key:"handleShowHelp",value:function(){this.setState({isShowHelp:!this.state.isShowHelp})}}]),t}(i.a.Component),v=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(d.a)(this,Object(c.a)(t).call(this,e))).state={isExample:!0,sidebarOpen:!1},n.onSetSidebarOpen=n.onSetSidebarOpen.bind(Object(h.a)(n)),n.handleExample=n.handleExample.bind(Object(h.a)(n)),n}return Object(p.a)(t,e),Object(l.a)(t,[{key:"onSetSidebarOpen",value:function(e){this.setState({sidebarOpen:e})}},{key:"handleExample",value:function(){this.setState({isExample:!0})}},{key:"render",value:function(){console.log("rerender main page"),console.log(this.state.isExample);i.a.createElement("div",{className:"sideNav"},i.a.createElement("a",{className:"menuItem",href:"#",onClick:this.handleExample}," Example "),i.a.createElement("a",{className:"menuItem",href:"#",onClick:this.handleExample}," Load Text "),i.a.createElement("a",{className:"menuItem",href:"#",onClick:this.handleExample}," Help "));return i.a.createElement(E,null)}}]),t}(i.a.Component);n(25),n(26);var y=function(){return i.a.createElement(v,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[14,1,2]]]);
//# sourceMappingURL=main.287b18c5.chunk.js.map